
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Guida italiana del framework PHP Yii 2.0">
      
      
      
        <meta name="author" content="Lorenzo Milicia">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.languages" content="">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.12.1">
    
    
      
        <title>Session & Cookies - YII2 - La guida italiana</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-e826f8942a.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-04ea671600.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-23f75ab9c7.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="teal" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="YII2 - La guida italiana" class="md-header-nav__button md-logo">
          
            <i class="md-icon md-icon--home"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Gestione delle richieste
                </span>
              
            
            Session & Cookies
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/Milicia4/Yii2-Ita.git" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="Homepage" class="md-tabs__link">
        Homepage
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../getting-started/sub-installing-Yii/" title="Come Iniziare" class="md-tabs__link">
          Come Iniziare
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../application-structure/sub-overview/" title="Struttura dell'Applicazione" class="md-tabs__link">
          Struttura dell'Applicazione
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../sub-request-overview/" title="Gestione delle richieste" class="md-tabs__link md-tabs__link--active">
          Gestione delle richieste
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon md-icon--home"></i>
      
    </span>
    YII2 - La guida italiana
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Milicia4/Yii2-Ita.git" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Homepage" class="md-nav__link">
      Homepage
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Come Iniziare
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Come Iniziare
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/sub-installing-Yii/" title="Installazione di Yii" class="md-nav__link">
      Installazione di Yii
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/sub-saying-hello/" title="Iniziamo con un "Ciao"" class="md-nav__link">
      Iniziamo con un "Ciao"
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/sub-working-with-forms/" title="Lavoriamo con i moduli" class="md-nav__link">
      Lavoriamo con i moduli
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/sub-working-with-database/" title="Lavoriamo con i database" class="md-nav__link">
      Lavoriamo con i database
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/sub-generate-code-gii/" title="Generare codice con Gii" class="md-nav__link">
      Generare codice con Gii
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../getting-started/sub-looking-ahead/" title="Guardiamo avanti" class="md-nav__link">
      Guardiamo avanti
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Struttura dell'Applicazione
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Struttura dell'Applicazione
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-overview/" title="Panoramica" class="md-nav__link">
      Panoramica
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-entry-script/" title="Entry Script" class="md-nav__link">
      Entry Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-applications/" title="Applicazioni" class="md-nav__link">
      Applicazioni
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-application-components/" title="Componenti applicativi" class="md-nav__link">
      Componenti applicativi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-controllers/" title="Controllori" class="md-nav__link">
      Controllori
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-models/" title="Modelli" class="md-nav__link">
      Modelli
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-views/" title="Viste" class="md-nav__link">
      Viste
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-modules/" title="Moduli" class="md-nav__link">
      Moduli
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-filters/" title="Filtri" class="md-nav__link">
      Filtri
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-widget/" title="Widget" class="md-nav__link">
      Widget
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-assets/" title="Assets" class="md-nav__link">
      Assets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../application-structure/sub-extensions/" title="Estensioni" class="md-nav__link">
      Estensioni
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Gestione delle richieste
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Gestione delle richieste
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-request-overview/" title="Panoramica sulla gestione delle richieste" class="md-nav__link">
      Panoramica sulla gestione delle richieste
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-bootstrapping/" title="Bootstrapping" class="md-nav__link">
      Bootstrapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-routing-url-creation/" title="Routing e creazione degli URL" class="md-nav__link">
      Routing e creazione degli URL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-requests/" title="Requests" class="md-nav__link">
      Requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-responses/" title="Responses" class="md-nav__link">
      Responses
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Session & Cookies
      </label>
    
    <a href="./" title="Session & Cookies" class="md-nav__link md-nav__link--active">
      Session & Cookies
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sessioni" title="Sessioni" class="md-nav__link">
    Sessioni
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apertura-e-chiusura-delle-sessioni" title="Apertura e chiusura delle sessioni" class="md-nav__link">
    Apertura e chiusura delle sessioni
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accesso-ai-dati-della-sessione" title="Accesso ai dati della sessione" class="md-nav__link">
    Accesso ai dati della sessione
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#archiviazione-personalizzata-di-una-sessione" title="Archiviazione personalizzata di una sessione" class="md-nav__link">
    Archiviazione personalizzata di una sessione
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dati-flash" title="Dati flash" class="md-nav__link">
    Dati flash
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies" title="Cookies" class="md-nav__link">
    Cookies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lettura-dei-cookie" title="Lettura dei cookie" class="md-nav__link">
    Lettura dei cookie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#invio-dei-cookies" title="Invio dei cookies" class="md-nav__link">
    Invio dei cookies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convalida-dei-cookier" title="Convalida dei cookier" class="md-nav__link">
    Convalida dei cookier
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-handling-error/" title="Gestione degli errori" class="md-nav__link">
      Gestione degli errori
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sub-logging/" title="Registrazione" class="md-nav__link">
      Registrazione
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sessioni" title="Sessioni" class="md-nav__link">
    Sessioni
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apertura-e-chiusura-delle-sessioni" title="Apertura e chiusura delle sessioni" class="md-nav__link">
    Apertura e chiusura delle sessioni
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#accesso-ai-dati-della-sessione" title="Accesso ai dati della sessione" class="md-nav__link">
    Accesso ai dati della sessione
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#archiviazione-personalizzata-di-una-sessione" title="Archiviazione personalizzata di una sessione" class="md-nav__link">
    Archiviazione personalizzata di una sessione
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dati-flash" title="Dati flash" class="md-nav__link">
    Dati flash
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies" title="Cookies" class="md-nav__link">
    Cookies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lettura-dei-cookie" title="Lettura dei cookie" class="md-nav__link">
    Lettura dei cookie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#invio-dei-cookies" title="Invio dei cookies" class="md-nav__link">
    Invio dei cookies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#convalida-dei-cookier" title="Convalida dei cookier" class="md-nav__link">
    Convalida dei cookier
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Milicia4/Yii2-Ita.git/edit/master/docs/handling-requests/sub-session-cookies.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="session-e-cookies">Session e Cookies<a class="headerlink" href="#session-e-cookies" title="Permanent link">&para;</a></h1>
<p>Le sessioni e i cookie consentono di mantenere i dati su più richieste degli utenti. In semplice PHP è possibile accedervi tramite le variabili globali <code>$_SESSION</code> e <code>$_COOKIE</code>. Yii incapsula sessioni e cookie come oggetti e quindi ti consente di accedervi in ​​modo orientato agli oggetti con ulteriori utili miglioramenti.</p>
<h2 id="sessioni">Sessioni<a class="headerlink" href="#sessioni" title="Permanent link">&para;</a></h2>
<p>Come le request e le responses , è possibile accedere alle sessioni tramite il componente <code>session</code> dell'applicazione, che è un'istanza di <strong><em>yii \ web \ Session</em></strong>, per impostazione predefinita.</p>
<h2 id="apertura-e-chiusura-delle-sessioni">Apertura e chiusura delle sessioni<a class="headerlink" href="#apertura-e-chiusura-delle-sessioni" title="Permanent link">&para;</a></h2>
<p>Per aprire e chiudere una sessione, puoi fare quanto segue:</p>
<pre><code>$session = Yii::$app-&gt;session;

// check if a session is already open
if ($session-&gt;isActive) ...

// open a session
$session-&gt;open();

// close a session
$session-&gt;close();

// destroys all data registered to a session.
$session-&gt;destroy();
</code></pre>
<p>Puoi chiamare <strong><em>open()</em></strong> e <strong><em>close()</em></strong> più volte,senza causare errori; internamente i metodi controlleranno prima se la sessione è già aperta.</p>
<h2 id="accesso-ai-dati-della-sessione">Accesso ai dati della sessione<a class="headerlink" href="#accesso-ai-dati-della-sessione" title="Permanent link">&para;</a></h2>
<p>Per accedere ai dati memorizzati nella sessione, è possibile effettuare le seguenti operazioni:</p>
<pre><code>$session = Yii::$app-&gt;session;

// get a session variable. The following usages are equivalent:
$language = $session-&gt;get('language');
$language = $session['language'];
$language = isset($_SESSION['language']) ? $_SESSION['language'] : null;

// set a session variable. The following usages are equivalent:
$session-&gt;set('language', 'en-US');
$session['language'] = 'en-US';
$_SESSION['language'] = 'en-US';

// remove a session variable. The following usages are equivalent:
$session-&gt;remove('language');
unset($session['language']);
unset($_SESSION['language']);

// check if a session variable exists. The following usages are equivalent:
if ($session-&gt;has('language')) ...
if (isset($session['language'])) ...
if (isset($_SESSION['language'])) ...

// traverse all session variables. The following usages are equivalent:
foreach ($session as $name =&gt; $value) ...
foreach ($_SESSION as $name =&gt; $value) ...
</code></pre>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Quando si accede ai dati della sessione attraverso il componente <code>session</code>, una sessione verrà aperta automaticamente se non è stata eseguita in precedenza. Questo è diverso dall'accedere ai dati della sessione attraverso <code>$_SESSION</code>, che richiede un esplicito richiamo di <code>session_start()</code>.</p>
</div>
<p>Quando si lavora con dati di sessione che sono matrici, il componente <code>session</code> presenta una limitazione che impedisce di modificare direttamente un elemento dell'array. Per esempio,</p>
<pre><code>$session = Yii::$app-&gt;session;

// the following code will NOT work
$session['captcha']['number'] = 5;
$session['captcha']['lifetime'] = 3600;

// the following code works:
$session['captcha'] = [
    'number' =&gt; 5,
    'lifetime' =&gt; 3600,
];

// the following code also works:
echo $session['captcha']['lifetime'];
</code></pre>
<p>È possibile utilizzare uno dei seguenti metodi per risolvere questo problema:</p>
<pre><code>$session = Yii::$app-&gt;session;

// directly use $_SESSION (make sure Yii::$app-&gt;session-&gt;open() has been called)
$_SESSION['captcha']['number'] = 5;
$_SESSION['captcha']['lifetime'] = 3600;

// get the whole array first, modify it and then save it back
$captcha = $session['captcha'];
$captcha['number'] = 5;
$captcha['lifetime'] = 3600;
$session['captcha'] = $captcha;

// use ArrayObject instead of array
$session['captcha'] = new \ArrayObject;
...
$session['captcha']['number'] = 5;
$session['captcha']['lifetime'] = 3600;

// store array data by keys with a common prefix
$session['captcha.number'] = 5;
$session['captcha.lifetime'] = 3600;
</code></pre>
<p>Per migliorare le prestazioni e la leggibilità del codice, consigliamo l'ultima soluzione. Cioè, invece di memorizzare una matrice come una singola variabile di sessione, si memorizza ogni elemento dell'array come una variabile di sessione che condivide lo stesso prefisso chiave con altri elementi dell'array.</p>
<h2 id="archiviazione-personalizzata-di-una-sessione">Archiviazione personalizzata di una sessione<a class="headerlink" href="#archiviazione-personalizzata-di-una-sessione" title="Permanent link">&para;</a></h2>
<p>La classe predefinita <strong><em>yii \ web \ Session</em></strong> memorizza i dati di sessione come file sul server. Yii fornisce inoltre le seguenti classi di sessione che implementano diverse sessioni di archiviazione:</p>
<ul>
<li><strong><em>yii \ web \ DbSession</em></strong>: memorizza i dati di sessione in una tabella di database.</li>
<li><strong><em>yii \ web \ CacheSession</em></strong>: memorizza i dati della sessione in una cache con l'aiuto di un componente configurato della cache.</li>
<li><strong><em>yii \ redis \ Session</em></strong>: memorizza i dati della sessione usando <strong><em>redis</em></strong> come supporto di memorizzazione.</li>
<li><strong><em>yii \ mongodb \ Session</em></strong>: memorizza i dati della sessione in un MongoDB.</li>
</ul>
<p>Tutte queste classi di sessione supportano lo stesso insieme di metodi API. Di conseguenza, è possibile passare a una classe di archiviazione di sessione diversa senza la necessità di modificare il codice dell'applicazione che utilizza le sessioni.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Se si desidera accedere ai dati della sessione <code>$_SESSION</code> durante l'utilizzo della memorizzazione della sessione personalizzata, è necessario assicurarsi che la sessione sia già stata avviata da <strong><em>yii \ web \ Session :: open()</em></strong>. Questo perché i gestori di archiviazione di sessione personalizzati sono registrati all'interno di questo metodo.</p>
</div>
<p>Per informazioni su come configurare e utilizzare queste classi di componenti, fare riferimento alla relativa documentazione API. Di seguito è riportato un esempio che mostra come configurare <strong><em>yii \ web \ DbSession</em></strong> nella configurazione dell'applicazione per utilizzare una tabella di database per l'archiviazione di sessione:</p>
<pre><code>return [
    'components' =&gt; [
        'session' =&gt; [
            'class' =&gt; 'yii\web\DbSession',
            // 'db' =&gt; 'mydb',  // the application component ID of the DB connection. Defaults to 'db'.
            // 'sessionTable' =&gt; 'my_session', // session table name. Defaults to 'session'.
        ],
    ],
];
</code></pre>
<p>È inoltre necessario creare la seguente tabella del database per memorizzare i dati della sessione:</p>
<pre><code>CREATE TABLE session
(
    id CHAR(40) NOT NULL PRIMARY KEY,
    expire INTEGER,
    data BLOB
)
</code></pre>
<p>dove 'BLOB' si riferisce al tipo BLOB del tuo DBMS preferito. Di seguito sono riportati i tipi di BLOB che possono essere utilizzati per alcuni DBMS popolari:</p>
<ul>
<li>MySQL: LONGBLOB</li>
<li>PostgreSQL: BYTEA</li>
<li>MSSQL: BLOB</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In base all'impostazione <code>php.ini</code> di <code>session.hash_function</code>, potrebbe essere necessario regolare la lunghezza della colonna <code>id</code>. Ad esempio, se <code>session.hash_function=sha256</code>, dovresti usare una lunghezza 64 invece di 40.</p>
</div>
<p>In alternativa, questo può essere realizzato con la seguente migrazione:</p>
<pre><code>&lt;?php

use yii\db\Migration;

class m170529_050554_create_table_session extends Migration{

    public function up(){

        $this-&gt;createTable('{{%session}}', [
            'id' =&gt; $this-&gt;char(64)-&gt;notNull(),
            'expire' =&gt; $this-&gt;integer(),
            'data' =&gt; $this-&gt;binary()
        ]);
        $this-&gt;addPrimaryKey('pk-id', '{{%session}}', 'id');
    }

    public function down(){

        $this-&gt;dropTable('{{%session}}');

    }
}
</code></pre>
<h2 id="dati-flash">Dati flash<a class="headerlink" href="#dati-flash" title="Permanent link">&para;</a></h2>
<p>I dati Flash sono un tipo speciale di dati di sessione che, una volta impostati in una richiesta, saranno disponibili solo durante la richiesta successiva e verranno automaticamente eliminati in seguito. I dati flash vengono comunemente utilizzati per implementare i messaggi che devono essere visualizzati una sola volta agli utenti finali, ad esempio un messaggio di conferma visualizzato dopo che un utente ha inviato correttamente un modulo.</p>
<p>È possibile impostare e accedere ai dati flash tramite il componente <code>session</code> dell'applicazione. Per esempio,</p>
<pre><code>$session = Yii::$app-&gt;session;

// Request #1
// set a flash message named as "postDeleted"
$session-&gt;setFlash('postDeleted', 'You have successfully deleted your post.');

// Request #2
// display the flash message named "postDeleted"
echo $session-&gt;getFlash('postDeleted');

// Request #3
// $result will be false since the flash message was automatically deleted
$result = $session-&gt;hasFlash('postDeleted');
</code></pre>
<p>Come i normali dati di sessione, è possibile memorizzare dati arbitrari come dati flash.</p>
<p>Quando chiami <strong><em>yii \ web \ Session :: setFlash()</em></strong>, sovrascriverà tutti i dati flash esistenti che hanno lo stesso nome. Per aggiungere nuovi dati flash a un messaggio esistente con lo stesso nome, è possibile chiamare <strong><em>yii \ web \ Session :: addFlash()</em></strong>. Per esempio:</p>
<pre><code>$session = Yii::$app-&gt;session;

// Request #1
// add a few flash messages under the name of "alerts"
$session-&gt;addFlash('alerts', 'You have successfully deleted your post.');
$session-&gt;addFlash('alerts', 'You have successfully added a new friend.');
$session-&gt;addFlash('alerts', 'You are promoted.');

// Request #2
// $alerts is an array of the flash messages under the name of "alerts"
$alerts = $session-&gt;getFlash('alerts');
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Cerca di non utilizzare <strong><em>yii \ web \ Session :: setFlash ()</em></strong> insieme a <strong><em>yii \ web \ Session :: addFlash ()</em></strong> per i dati flash con lo stesso nome. Questo perché il secondo metodo trasformerà automaticamente i dati flash in una matrice in modo che possa aggiungere nuovi dati flash con lo stesso nome. Di conseguenza, quando chiami <strong><em>yii \ web \ Session :: getFlash ()</em></strong>, potresti trovare a volte una matrice mentre a volte ottieni una stringa, a seconda dell'ordine di invocazione di questi due metodi.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Per la visualizzazione dei messaggi Flash è possibile utilizzare il widget <code>Alert</code> di avvio nel seguente modo:</p>
<pre><code>echo Alert::widget([
    'options' =&gt; ['class' =&gt; 'alert-info'],
    'body' =&gt; Yii::$app-&gt;session-&gt;getFlash('postDeleted'),
]);
</code></pre>
</div>
<h2 id="cookies">Cookies<a class="headerlink" href="#cookies" title="Permanent link">&para;</a></h2>
<p>Yii rappresenta ciascun cookie come oggetto di <strong><em>yii \ web \ Cookie</em></strong>. Sia <strong><em>yii \ web \ Request</em></strong> che <strong><em>yii \ web \ Response</em></strong> gestiscono una raccolta di cookie tramite la proprietà denominata cookies. La raccolta di cookie nel primo, rappresenta i cookie inviati in una richiesta,mentre la raccolta di cookie in quest'ultimo, rappresenta i cookie che devono essere inviati all'utente.</p>
<p>La parte dell'applicazione che riguarda direttamente la richiesta e la risposta è il controller. Pertanto, i cookie devono essere letti e inviati nel controller.</p>
<h2 id="lettura-dei-cookie">Lettura dei cookie<a class="headerlink" href="#lettura-dei-cookie" title="Permanent link">&para;</a></h2>
<p>È possibile ottenere i cookie nella richiesta corrente utilizzando il seguente codice:</p>
<pre><code>// get the cookie collection (yii\web\CookieCollection) from the "request" component
$cookies = Yii::$app-&gt;request-&gt;cookies;

// get the "language" cookie value. If the cookie does not exist, return "en" as the default value.
$language = $cookies-&gt;getValue('language', 'en');

// an alternative way of getting the "language" cookie value
if (($cookie = $cookies-&gt;get('language')) !== null) {
    $language = $cookie-&gt;value;
}

// you may also use $cookies like an array
if (isset($cookies['language'])) {
    $language = $cookies['language']-&gt;value;
}

// check if there is a "language" cookie
if ($cookies-&gt;has('language')) ...
if (isset($cookies['language'])) ...
</code></pre>
<h2 id="invio-dei-cookies">Invio dei cookies<a class="headerlink" href="#invio-dei-cookies" title="Permanent link">&para;</a></h2>
<p>Puoi inviare cookie agli utenti finali utilizzando il seguente codice:</p>
<pre><code>// get the cookie collection (yii\web\CookieCollection) from the "response" component
$cookies = Yii::$app-&gt;response-&gt;cookies;

// add a new cookie to the response to be sent
$cookies-&gt;add(new \yii\web\Cookie([
    'name' =&gt; 'language',
    'value' =&gt; 'zh-CN',
]));

// remove a cookie
$cookies-&gt;remove('language');
// equivalent to the following
unset($cookies['language']);
</code></pre>
<p>Oltre al nome, alle proprietà del valore mostrate negli esempi precedenti, la classe <strong><em>yii \ web \ Cookie</em></strong> definisce anche altre proprietà per rappresentare completamente tutte le informazioni sui cookie disponibili, come il dominio, la scadenza, ecc.. È possibile configurare queste proprietà come necessario per preparare un cookie e quindi aggiungerlo alla raccolta di cookie della risposta.</p>
<h2 id="convalida-dei-cookier">Convalida dei cookier<a class="headerlink" href="#convalida-dei-cookier" title="Permanent link">&para;</a></h2>
<p>Durante la lettura e l'invio di cookie tramite i componenti <code>request</code> e <code>response</code> come mostrato nelle ultime due sottosezioni, si gode della maggiore sicurezza della convalida dei cookie che protegge i cookie dalla modifica sul lato client. Ciò si ottiene firmando ogni cookie con una stringa <strong>hash</strong>, che consente all'applicazione di stabilire se un cookie è stato modificato sul lato client. In tal caso, il cookie NON sarà accessibile tramite i cookie <strong><em>yii \ web \ Request ::</em></strong> del componente <code>request</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>La convalida dei cookie protegge solo i valori dei cookie dalla modifica. Se un cookie non supera la convalida, puoi comunque accedervi <code>$_COOKIE</code>. Ciò è dovuto al fatto che le librerie di terze parti possono manipolare i cookie a modo loro, il che non implica la convalida dei cookie.</p>
</div>
<p>La convalida dei cookie è abilitata per impostazione predefinita. È possibile disabilitarlo impostando la proprietà <strong><em>Yii \ web \ Request :: $ enableCookieValidation</em></strong>  di essere <code>false</code>, anche se si consiglia vivamente di non farlo.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>I cookie che vengono letti direttamente / inviati tramite <code>$_COOKIE</code> e <code>setcookie()</code> NON saranno convalidati.</p>
</div>
<p>Quando si utilizza la convalida dei cookie, è necessario specificare un <strong><em>yii \ web \ Request :: $ cookieValidationKey</em></strong> che verrà utilizzato per generare le stringhe <code>hash</code> summenzionate. È possibile farlo configurando il componente <code>request</code> nella configurazione dell'applicazione:</p>
<pre><code>return [
    'components' =&gt; [
        'request' =&gt; [
            'cookieValidationKey' =&gt; 'fill in a secret key here',
        ],
    ],
];
</code></pre>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p><strong><em>cookieValidationKey</em></strong> è fondamentale per la sicurezza dell'applicazione. Dovrebbe essere noto solo alle persone di cui ti fidi. Non memorizzarlo nel sistema di controllo della versione.</p>
</div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../sub-responses/" title="Responses" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Responses
              </span>
            </div>
          </a>
        
        
          <a href="../sub-handling-error/" title="Gestione degli errori" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Gestione degli errori
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © MIT - Lorenzo Milicia - 2017
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-946997f430.js"></script>
      
      
      <script>app.initialize({version:"0.16.3",url:{base:"../.."}})</script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-109845735-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>